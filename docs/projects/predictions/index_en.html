<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Article">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Data-driven Predictions | Ideation &amp; Prototyping Lab</title>
        <meta name="description" content="{PROJECT_DESCRIPTION_EN}}">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <link type="text/plain" rel="author" href="../../humans.txt" />
        <link rel="manifest" href="../../site.webmanifest">
        <link rel="apple-touch-icon" href="../../icons/icon.png">

        <link rel="icon" type="image/png" href="../../icons/favicon-alpha-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="../../icons/favicon-alpha-96x96.png" sizes="96x96">
        <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico">

        <!-- FACEBOOK -->
        <meta property="fb:app_id" content="487094758334595">
        <meta property="og:url" content="http://lab.technologiestiftung-berlin.de/projects/predictions/index.html">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Data-driven Predictions based on Open Data">
        <meta property="og:image" content="http://lab.technologiestiftung-berlin.de/projects/predictions/social_media.jpg">
        <meta property="og:description" content="Good prediction models, especially in the domain of machine-learning, are buid upon big data sets. What role can governmental open data play in this context?">
        <meta property="og:site_name" content="Ideation &amp; Prototyping Lab">
        <meta property="article:author" content="Sebastian Meier">

        <!-- TWITTER -->
        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@TSBBerlin">
        <meta name="twitter:creator" content="seb_meier">
        <meta name="twitter:url" content="http://lab.technologiestiftung-berlin.de/projects/predictions/index.html">
        <meta name="twitter:title" content="Data-driven Predictions based on Open Data">
        <meta name="twitter:description" content="Good prediction models, especially in the domain of machine-learning, are buid upon big data sets. What role can governmental open data play in this context?">
        <meta name="twitter:image" content="http://lab.technologiestiftung-berlin.de/projects/predictions/social_media.jpg">

        <!-- GOOGLE+/SCHEMA.ORG -->
        <meta itemprop="name" content="Data-driven Predictions based on Open Data">
        <meta itemprop="description" content="Good prediction models, especially in the domain of machine-learning, are buid upon big data sets. What role can governmental open data play in this context?">
        <meta itemprop="image" content="http://lab.technologiestiftung-berlin.de/projects/predictions/social_media.jpg">

        <!-- CANONICAL URL -->
        <link rel="canonical" href="http://lab.technologiestiftung-berlin.de/projects/predictions/index.html">
        <!--<link rel="shortlink" href="tsblab.de/projects/PROJECT">-->

        <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,300i|Kalam:700|Barlow:400,400i,700,700i" rel="stylesheet">
        <meta name="theme-color" content="#1e3791">
        <link href="../../js/prism/prism.css" rel="stylesheet" />
        <link rel="stylesheet" href="../../css/style.css">
        <link rel="stylesheet" href="style.css">
    </head>
    <body class="project">
        <header id="page-head">
            <div class="container">
                <div class="left">
                    <div id="minilogo"><svg viewBox="0 0 254 190" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" transform="translate(-1875.000000, -2479.000000)" stroke-linecap="round" stroke-linejoin="round"><g transform="translate(1875.000000, 2478.000000)" fill="#000000" fill-rule="nonzero" stroke-width="7"><g id="logo" transform="translate(128.500000, 100.500000) rotate(4.000000) translate(-128.500000, -100.500000) translate(7.000000, 9.000000)"><path d="M0.316967317,116.55394 L61.6724044,179.221053" stroke="#6ECDF5"></path><path d="M61.6724044,179.221053 L232.546021,4.8771611" stroke="#6ECDF5"></path><path d="M0.316967317,116.55394 L233.101334,4.23466223" stroke="#6ECDF5"></path><path d="M1.51109571,116.469957 L203.326978,154.172387" stroke="#6ECDF5"></path><path d="M233.101334,4.23466223 L203.285227,153.57188" stroke="#6ECDF5"></path><path d="M203.924042,154.130395 L239.525752,116.998677" stroke="#6ECDF5"></path><path d="M239.525752,116.998677 L78.6538161,0.61431818" stroke="#6ECDF5"></path><path d="M16.3120027,125.946118 L78.6538161,0.61431818" stroke="#6ECDF5"></path><path d="M15.6568751,125.27333 L43.1256029,182.634752" stroke="#E60433"></path><path d="M43.1256029,182.634752 L200.909747,6.01962679" stroke="#E60433"></path><path d="M15.6568751,125.27333 L200.909747,6.01962679" stroke="#E60433"></path><path d="M15.6568751,125.27333 L221.975051,144.339786" stroke="#E60433"></path><path d="M200.909747,6.01962679 L221.975051,144.339786" stroke="#E60433"></path><path d="M221.975051,144.339786 L242.948866,114.17657" stroke="#E60433"></path><path d="M242.948866,114.17657 L73.0003868,18.307288" stroke="#E60433"></path><path d="M15.6568751,125.27333 L73.0003868,18.307288" stroke="#E60433"></path></g></g></g></svg></div>
                    <span>
                        <a class="lab-logo" href="http://lab.technologiestiftung-berlin.de">Ideation&nbsp;&amp; Prototyping&nbsp;Lab</a><br />
                        <a href="http://www.technologiestiftung-berlin.de">Technologiestiftung Berlin</a>
                    </span>
                </div>
                <div class="right">
                    <nav id="page-nav">
                        <ul>
                            <li><a href="http://lab.technologiestiftung-berlin.de">Back to the Lab</a>&nbsp;<span class="arrow">&#8614;</span></li>
                            <li class="lang"><a href="http://lab.technologiestiftung-berlin.de/projects/predictions/index_en.html">Deutsch</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>
        <main>
            <div id="title">
                <div class="container">
                    <span class="button tag">Data Science</span>
                    <h1>Data-driven Predictions based on Open Data</h1>
                    <span class="title-subline">Sebastian Meier (<a href="https://twitter.com/seb_meier">@seb_meier</a>) | 10/2017</span>
                </div>
            </div>

            <!-- Start editing here -->

            <div class="container p-bottom">
                <p class="copy">
                    Predictions which are based on historic data are an essential tool for research, administration and the industry. Especially in the growing domain of machine learning, historic data is an important asset for training algorithms. Open Data (e.g. from the goverment) can be an interesting addition to traditinal data sources. Using Berlin's historic population data (download link below), one can for example predict future changes in the population of certain districts. In the example below we focused on children whose parents can apply for a place in a day care center, which could be used to foresee future bottlenecks in Berlin's day care infrastructure. This prediction could be further refined by including more relevant data sets.
                </p>
                <blockquote class="center"><p>Sustainable data management of historic data.</p></blockquote>
                <p class="copy">
                    In order to get the most out of open data provided by the various initiatives, one needs to pay attention to a few key points in regards to data management and data provision. First of all it is important to provide the facilities to actually provide historic data and not only the latest data. Even more important are systematic structures for current and historic data. If, for example, a spatial statistical area changes over time, this change needs to be documented and integrated into the data structure, in order to allow for correct temporal analysis.
                </p>
            </div>

            <div class="special-section">
              <div id="trends">
                <div class="col" id="trend-1">
                  <div class="top"></div>
                  <div class="mid">
                    <h2>Kita-Children per District</h2>
                    <div class="inner"></div>
                  </div>
                  <div class="bottom"></div>
                </div>
                <div class="col" id="trend-2">
                  <div class="top"></div>
                  <div class="mid">
                    <h2></h2>
                    <div class="inner"></div>
                  </div>
                  <div class="bottom"></div>
                </div>
                <div class="col no-bg" id="trend-3">
                  <div class="top"></div>
                  <div class="mid">
                    <h2></h2>
                    <div class="inner"></div>
                    <div id="trend-info">
                      <p class="interaction-info">
                        <img src="./images/touch@2x.png" /> Hover with your cursor over the districts to learn more about the population changes.<br />Click on a <span class="trend-type">district</span> for more details.
                      </p>
                      <p class="prediction-info">
                        <span class="color-block blue"></span> The area highlighted in blue is a statistical prediction* for the year 2017.
                      </p>
                    </div>
                  </div>
                  <div class="bottom"></div>
                </div>
              </div>
              <hr class="clear" />
            </div>

            <div class="container p-top">
                <ul class="download-list">
                    <li>
                        <a href="/data/EWR.zip">
                            <span class="download-icon"></span>
                            <span class="download-title">Population data in age groups from 2001 to 2016.</span><br />
                            <span class="download-subtitle">ZIP, 0,6 MB - CCBY<br />Amt für Statistik Berlin-Brandenburg</span>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="container p-bottom p-top">
                <h2>*statistical Prediction</h2>
                <p class="copy">
                    For the statistical prediction of population variation a relatively simple statistical algorithm, a weighted linear regression, was used. The weighting resulted in more recent changes are ranked higher than older changes. The code for the predictions as well as for the visualisation above can be found on GitHub.
                </p>
            </div>

            <div class="container center">
                <a id="github" href="https://github.com/technologiestiftung/{{GITHUB_URL_EN}}">
                    <img src="../../images/github.svg" alt="Project on Github" />
                    <span class="github-title">technologiestiftung/population-prediction</span><br />
                    <span class="github-subline">Visit Project on GitHub</span>
                    <hr class="clear" />
                </a>
            </div>

            <div id="author" class="container small p-top p-d-bottom">
                <img src="../../images/team/author_sebastian_meier.png" alt="Sebastian Meier" />
                <h3>About the author</h3>
                <h2>Sebastian Meier</h2>
                <p>Sebastian Meier is a data scientist at the Technologiestiftung Berlin. He graduated in Communication and Interface Design and is currently finishing his PhD in Geoinformatics at Potsdam University. His research focus lies on spatial data analytics and visualisation as well as human-centred perspectives on software interfaces.<br /><br /><a href="mailto:meier@technologiestiftung-berlin.de">meier@technologiestiftung-berlin.de</a></p>
                <hr class="clear" />
            </div>

            <!-- Stop editing here -->

        </main>
        <footer id="contact">
            <div id="footer">
                <div class="container">
                    <a href="http://www.technologiestiftung-berlin.de"><img src="../../images/tsb-logo.png" alt="Technologiestiftung Berlin" /></a>
                    <div class="contact-meta">
                        Grunewaldstraße 61-62<br />
                        10825 Berlin<br />
                        +49 30 209 69 99-0<br />
                        <a href="mailto:info@technologiestiftung-berlin.de">info@technologiestiftung-berlin.de</a>
                    </div>
                    <div class="contact-social">
                        <a href="https://twitter.com/tsbberlin"><img src="../../images/twitter.png" alt="Twitter"></a>
                        <a href="https://www.facebook.com/Technologiestiftung/"><img src="../../images/facebook.png" alt="Facebook"></a>
                    </div>
                </div>
            </div>
            <div id="end">
                <div class="container">
                    <div class="left">© Technologiestiftung Berlin 2017</div>
                    <div class="right">
                        <a href="https://www.technologiestiftung-berlin.de/de/stiftung/kontakt-anfahrt/" target="_blank">Kontakt</a>
                        &nbsp;|&nbsp;
                        <a href="https://www.technologiestiftung-berlin.de/de/impressum" target="_blank">Impressum</a>
                        &nbsp;|&nbsp;
                        <a href="https://www.technologiestiftung-berlin.de/de/datenschutz/" target="_blank">Datenschutz</a>
                    </div>
                </div>
            </div>
        </footer>
        <script src="../../js/min/d3.v4.min.js"></script>
        <script src="../../js/prism/prism.js"></script>
        <script type="text/javascript" src="../../js/min/logo.min.js"></script>
        <script type="text/javascript" src="../../js/min/script.min.js"></script>
        <!-- Add your custom JS files here and place them directly in your project folder -->
        <script type="text/javascript">
            /*
                Init Custom Code hier
            */

            var vis = {};

            var trend = (function (container, _level, _dict, _label){

              container.selectAll('*').remove();

              if(_level>1){
                d3.select(container.node().parentNode).selectAll('h2').text(_label);
              }

              var module = {},
                  level = _level,
                  padding = 60,
                  el_margin = 10,
                  width = container.node().getBoundingClientRect().width-5,
                  el_height = 50, els = [],
                  dict = _dict, csv = null, csv_keys = {},
                  svg = container.append('svg').attr('width',width),
                  years = [2001,2016,2017];

              module.draw = function(){
                svg.selectAll('*').remove();

                var root_count = 0;
                for(var key in dict){
                  root_count++;
                }

                svg.attr('height', root_count*(el_height+el_margin)+50+3);

                var x = d3.scaleLinear().domain([years[0],years[2]]).range([0,width-padding]);
                var max = 0;
                for(var i in dict){
                  max = d3.max([max, d3.max(dict[i].sum)]);
                }
                var y = d3.scaleLinear().range([el_height,0]).domain([0,max]);
                var xAxisBottom = d3.axisBottom().scale(x).tickFormat(function(d){ return "'"+(((d-2000)<10)?'0':'')+(d-2000); }).ticks(10);
                var xAxisTop = d3.axisTop().scale(x).tickFormat(function(d){ return "'"+(((d-2000)<10)?'0':'')+(d-2000); }).ticks(10);
                var yAxis = d3.axisLeft().scale(y).tickFormat(d3.format("")).ticks(3);
                var line = d3.line()
                  .x(function(d,i){return x(years[0]+i);})
                  .y(function(d){ return y(d);});

                var ic = 0;
                for(var i in dict){
                  var g = svg.append('g')
                    .attr('class','visgroup')
                    .attr('transform','translate('+(padding-2)+','+ (ic*(el_height+el_margin)+35)+')');

                  g.append('rect')
                    .attr('width',x(years[1]))
                    .attr('height', el_height)
                    .attr('class', 'bg-normal');

                  g.append('rect')
                    .attr('width',(x(years[0]+1)))
                    .attr('transform','translate('+x(years[1])+',0)')
                    .attr('height', el_height)
                    .attr('class', 'bg-predict');            

                  g.selectAll('line').data(new Array(5)).enter().append('line')
                    .attr('x1', 0)
                    .attr('x2', x(years[2]))
                    .attr('class', 'ylines')
                    .style('stroke', 'rgba(0,0,0,0.1)')
                    .attr('y1', function(d,i){ return i*10; })
                    .attr('y2', function(d,i){ return i*10; });

                  g.append('text')
                    .attr('dx',5)
                    .attr('dy',(y(dict[i].sum[0])>35)?15:45)
                    .attr('class', 'label')
                    .text(dict[i].n);

                  g.append('path')
                    .attr('class', 'trend')
                    .attr('d', line(dict[i].sum));

                  var tooltip = g.append('g')
                    .attr('class', 'tooltip')
                    .style('display', 'none');

                  tooltip.append('line')
                    .attr('x1', 0)
                    .attr('x2', 0)
                    .attr('y1', 0)
                    .attr('y2', el_height);

                  tooltip.append('rect')
                    .attr('x', -18)
                    .attr('y', el_height/2-9)
                    .attr('width', 36)
                    .attr('height', 10)
                    .style('fill','#000')
                    .style('stroke-linejoin','round')
                    .style('stroke-width',8)
                    .style('stroke','#000');

                  tooltip.append('text')
                    .datum(dict[i].sum)
                    .attr('class','label')
                    .attr('text-anchor','middle')
                    .attr('dy', el_height/2)
                    .style('fill','#fff');

                  g.append('g')
                    .attr('class', 'axis')
                    .style('display', (ic!=0)?'none':'block')
                    .attr('transform','translate('+(-9)+','+0+')')
                    .call(yAxis);

                  g.append('rect')
                    .datum(dict[i])
                    .attr('width',(x(years[2])))
                    .attr('height', el_height)
                    .attr('class', 'bg-overlay')
                    .style('fill','transparent')
                    .on('mouseenter', function(d){
                      svg.selectAll('.axis').style('display','none');
                      svg.selectAll('path.trend').style('stroke-width',1);
                      var group = d3.select(this.parentNode);
                        group.select('.axis').style('display','block');
                        group.select('path.trend').style('stroke-width','3');
                    })
                    .on('mousemove', function(){
                      var year = Math.round(x.invert(d3.mouse(this)[0]));

                      var tooltip = svg.selectAll('.tooltip')
                        .style('display','block')
                        .attr('transform','translate('+ x(year) +',0)');

                      tooltip.select('.label')
                        .attr('dx', ((year == years[2])?-19:((year == years[0])?19:0)))
                        .text(function(d){
                          return Math.round(d[year-years[0]]);
                        });

                      tooltip.select('rect')
                        .attr('x', ((year == years[2])?-38:((year == years[0])?2:-18)));

                    })
                    .on('mouseleave', function(d){
                      svg.selectAll('.tooltip').style('display','none');
                      svg.selectAll('path.trend').style('stroke-width',1);
                    })
                    .on('click', function(d){
                      if(level<3){
                        if(level == 1){
                          d3.select('#trend-3 h2').text('');
                          d3.select('#trend-3 svg').remove();
                          d3.select("#trend-3"+(level+1)+' .inner').style('display','none');
                        }
                        svg.selectAll('.visgroup').classed('active',false);
                        d3.select(this.parentNode).classed('active',true);
                        d3.select("#trend-"+(level+1)).style('display','block');
                        vis['trend_'+(level+1)] = trend(d3.select("#trend-"+(level+1)+" .inner"), (level+1), d.c, d.n);
                      }
                    });

                  ic++;
                }

                svg.append('g')
                  .attr('transform','translate('+(padding-2)+','+23+')')
                  .call(xAxisTop);

                svg.append('g')
                  .attr('transform','translate('+(padding-2)+','+(ic*(el_height+el_margin)+35)+')')
                  .call(xAxisBottom);
              }

              function processDict(dict){
                for(var key in dict){
                  dict[key]['sum'] = [];

                  for(var i = years[0]; i<=years[2]; i++){
                    dict[key].sum.push(+csv[csv_keys[dict[key].fid]][i]);
                  }

                  processDict(dict[key].c);
                }
              }

              module.update = function(){
                width = container.node().getBoundingClientRect().width-5;
                svg.attr('width',width);
                module.draw();
              };

              if(!dict){
                d3.json('./data/lor_dict.json', function(err, data){
                  if(err){console.log(err);}

                  dict = data;

                  d3.csv('./data/EWR.min.csv', function(err, data){
                    if(err){console.log(err);}

                    csv = data;
                    csv.forEach(function(c,ci){
                      csv_keys[c.fid] = ci;
                      csv_keys[c.id] = ci;
                    });

                    processDict(dict);

                    module.draw();

                  });
                });
              }else{
                module.draw();
              }

              return module;
            });

        var trendVis = trend(d3.select("#trend-1 .inner"),1,false,false);

        d3.select(window).on('resize', debounce(function(){
          trendVis.update();
          for(var v in vis){
            vis[v].update();
          }
        }));
        </script>
    </body>
</html>
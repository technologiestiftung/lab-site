"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var histodots=function(t){var e={},a=t.container||d3.select("body"),n=t.height||250,r=t.width||500,o=t.data,i=t.data_column||"value",s=t.zero_based||!1,c=t.colors||["#2e91d2","#E60032"],l=a.append("svg").attr("width",r).attr("height",n).attr("viewBox","0 0 ".concat(r," ").concat(n)).attr("preserveAspectRatio","xMidYMid meet"),d=t.margin||{top:20,right:20,bottom:30,left:50},u=r-d.left-d.right,p=n-d.top-d.bottom,h=l.append("g").attr("transform","translate(".concat(d.left,",").concat(d.top,")")),f=t.parseTime||d3.timeParse("%Y-%m-%d"),m=t.isTime||!1,g=(t.equalize,[]);o.forEach(function(t){m?"NaN"!=t[i]&&g.push(f(t[i])):"NaN"!=t[i]&&g.push(+t[i])});var y=t.maxValue||d3.max(g),v=d3.scaleLinear().domain([s?0:d3.min(g),y]).range(c),b=t.bins||d3.thresholdSturges(g,d3.min(g),y),x=d3.histogram().thresholds(b)(g),_=[];x.forEach(function(t){var e=d3.extent(t);isNaN(e[0])||isNaN(e[1])?_.push({count:t.length,label:"-"}):Math.floor(e[0])!=Math.floor(e[1])?_.push({count:t.length,label:Math.floor(e[0])+"-"+Math.floor(e[1])}):_.push({count:t.length,label:Math.floor(e[0])})});var k=0;return _.forEach(function(t,e){if(t.count>0){var a=Math.floor(u/8),n=h.append("g").attr("transform","translate(0,".concat(k,")")),r=n.append("text").text(t.label).style("font-family","sans-serif").style("font-size",10).node().getBoundingClientRect();x[e]=x[e].sort(),n.append("line").attr("x1",r.width+10).attr("y1",0).attr("y2",0).attr("x2",u).style("stroke-dasharray","3,3").style("stroke","black"),n.append("g").attr("transform","translate(".concat(4,",").concat(14,")")).selectAll("circle").data(x[e]).enter().append("circle").attr("r",3).style("fill",function(t){return v(t)}).attr("cy",function(t,e){return 8*Math.floor(e/a)}).attr("cx",function(t,e){return 8*(e-Math.floor(e/a)*a)}),k+=10*(e==_.length-1?1:3)+8*Math.ceil(t.count/a)}}),n=k+d.top+d.bottom,l.attr("height",n).attr("viewBox","0 0 ".concat(r," ").concat(n)),e.svg=function(){return l},e.g=function(){return h},e.dHeight=function(){return p},e.dWidth=function(){return u},e},lineChart=function(t){var e={},a=t.container||d3.select("body"),n=t.height||250,r=t.width||500,o=t.xTickNum||!1,i=t.data,s=t.xGrid||!1,c=t.yGrid||!1,l=t.xLabel||!1,d=t.yLabel||!1,u=t.group_sort||!1,p=t.date_column||"date",h=t.data_column||"value",f=t.zero_based||!1,m=t.group_column||!1,g=t.colors||"#000",y=a.append("svg").attr("width",r).attr("height",n).attr("viewBox","0 0 ".concat(r," ").concat(n)).attr("preserveAspectRatio","xMidYMid meet"),v=t.margin||{top:20,right:20,bottom:30,left:50},b=r-v.left-v.right,x=n-v.top-v.bottom,_=y.append("g").attr("transform","translate(".concat(v.left,",").concat(v.top,")")),k=t.parseTime||d3.timeParse("%Y-%m-%d"),w=t.isTime||!1,T=t.xTicks||!1;i.forEach(function(t){t[p]=w?k(t[p]):+t[p],t[h]=+t[h]});var B=t.x||1==w?d3.scaleTime().rangeRound([0,b]).domain(d3.extent(i,function(t){return t[p]})):d3.scaleLinear().range([0,b]).domain(d3.extent(i,function(t){return t[p]})),M=t.y||d3.scaleLinear().rangeRound([x,0]).domain(f?[0,d3.max(i,function(t){return t[h]})]:d3.extent(i,function(t){return t[h]})),A=t.line||d3.line().x(function(t){return B(t[p])}).y(function(t){return M(t[h])}),L=d3.axisBottom(B);if(T&&L.tickFormat(T),o&&L.ticks(o),s){var z=d3.axisBottom(B);T&&z.tickFormat(T),o&&z.ticks(o),_.append("g").attr("transform","translate(0,".concat(x,")")).attr("class","gridline").call(z.tickSize(-x).tickFormat(""))}if(c){var N=d3.axisLeft(M);_.append("g").attr("class","gridline").call(N.tickSize(-b).tickFormat(""))}if(_.append("g").attr("transform","translate(0,"+x+")").call(L),_.append("g").call(d3.axisLeft(M)),m){var E=[];u?E=u:i.forEach(function(t){-1==E.indexOf(t[m])&&E.push(t[m])}),E.forEach(function(t,e){_.append("path").attr("class","path").attr("id","path_"+t).datum(i.filter(function(e){return e[m]==t})).attr("fill","none").attr("stroke","object"==_typeof(g)?g[t]:g).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke-width",1.5).attr("d",A)})}else _.append("path").datum(i).attr("class","path").attr("fill","none").attr("stroke","object"==_typeof(g)?g[key]:g).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("stroke-width",1.5).attr("d",A);return l&&_.append("g").attr("transform","translate(".concat(b,",").concat(x+10,")")).append("text").text(l).attr("text-anchor","end").attr("fill","#000").style("font-size",10).style("font-family","sans-serif"),d&&_.append("g").append("text").attr("fill","#000").attr("transform","rotate(-90)").style("font-size",10).style("font-family","sans-serif").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text(d),e.svg=function(){return y},e.x=function(t){return B(t)},e.y=function(t){return M(t)},e.g=function(){return _},e.dHeight=function(){return x},e.dWidth=function(){return b},e.parseTime=function(t){return k(t)},e},histogram=function(t){var e={},a=t.container||d3.select("body"),n=t.height||250,r=t.width||500,o=t.data,i=t.data_column||"value",s=(t.zero_based,t.colors,a.append("svg").attr("width",r).attr("height",n).attr("viewBox","0 0 ".concat(r," ").concat(n)).attr("preserveAspectRatio","xMidYMid meet")),c=t.margin||{top:20,right:20,bottom:30,left:50},l=r-c.left-c.right,d=n-c.top-c.bottom,u=s.append("g").attr("transform","translate(".concat(c.left,",").concat(c.top,")")),p=t.parseTime||d3.timeParse("%Y-%m-%d"),h=t.isTime||!1,f=t.equalize||!1,m=[];o.forEach(function(t){h?"NaN"!=t[i]&&m.push(p(t[i])):"NaN"!=t[i]&&m.push(+t[i])});var g=t.maxValue||d3.max(m),y=t.bins||d3.thresholdSturges(m,d3.min(m),g),v=d3.scaleLinear().domain([d3.min(m),g]).range([0,l]),b=d3.histogram().domain(v.domain()).thresholds(y)(m),x=[];b.forEach(function(t){var e=d3.extent(t);isNaN(e[0])||isNaN(e[1])?x.push({count:t.length,label:"-"}):Math.floor(e[0])!=Math.floor(e[1])?x.push({count:t.length,label:Math.floor(e[0])+"-"+Math.floor(e[1])}):x.push({count:t.length,label:Math.floor(e[0])})});for(var _=t.maxLength||d3.max(b,function(t){return f?f(t.length):t.length}),k=[],w=0;w<x.length;w++)k.push(w);var T=d3.scaleBand().domain(k).range([0,l]),B=d3.scaleLinear().domain([0,_]).nice().range([d,0]);return u.append("g").call(d3.axisLeft(B)).call(function(t){return t.select(".domain").remove()}).call(function(t){return t.selectAll(".tick line").attr("x1",l).style("stroke","rgba(0,0,0,0.1)")}).call(function(t){return t.select(".tick:last-of-type text").clone().attr("x",4).attr("text-anchor","start").attr("font-weight","bold").text(o.y)}),u.append("g").attr("transform","translate(0,".concat(d,")")).call(d3.axisBottom(T).tickFormat(function(t){return x[t].label})),u.append("g").call(d3.axisBottom(T).tickFormat(function(t){return x[t].count>0?f?Math.round(f(x[t].count)):x[t].count:""})).call(function(t){return t.selectAll(".tick line").style("stroke",function(t){return x[t].count>0?"#000":"transparent"})}).call(function(t){return t.selectAll(".tick text").attr("dy",-12)}).call(function(t){return t.selectAll(".tick").attr("transform",function(t,e){return"translate(".concat(T(e)+T.bandwidth()/2,",").concat(B(f?f(x[t].count):x[t].count)-7,")")})}).call(function(t){return t.select(".domain").remove()}),u.append("g").attr("fill","#000").selectAll("rect").data(b).enter().append("rect").attr("x",function(t,e){return l/b.length*e+1}).attr("width",function(t){return Math.max(0,v(t.x1)-v(t.x0)-2)}).attr("y",function(t){var e=B(f?f(t.length):t.length);return e>d-1&&t.length>0&&(e=d-1),e}).attr("height",function(t){var e=B(0)-B(f?f(t.length):t.length);return e>0&&e<1&&(e=1),e}),e.svg=function(){return s},e.g=function(){return u},e.dHeight=function(){return d},e.dWidth=function(){return l},e},stackedArea=function(t){var e={},a=t.container||d3.select("body"),n=t.height||250,r=t.width||500,o=t.data,i=t.date_column||"date",s=(t.data_column,t.zero_based,t.colors,a.append("svg").attr("width",r).attr("height",n).attr("viewBox","0 0 ".concat(r," ").concat(n)).attr("preserveAspectRatio","xMidYMid meet")),c=t.margin||{top:20,right:20,bottom:30,left:50},l=r-c.left-c.right,d=n-c.top-c.bottom,u=s.append("g").attr("transform","translate(".concat(c.left,",").concat(c.top,")")),p=t.parseTime||d3.timeParse("%Y-%m-%d"),h=t.isTime||!1,f=[],m=d3.max(o,function(t){return d3.sum(d3.keys(t).map(function(e){return e!==i?t[e]:0}))});o.forEach(function(t){var e=0;for(var a in t)h&&a==i?t[a]=p(t[a]):(t[a]=+t[a],e+=t[a]);f.push(e)});var g=[];o.forEach(function(t,e){var a={};for(var n in t)a[n]=h&&n==i?t[n]:t[n]/f[e]*m;g.push(a)});var y=o.columns.filter(function(t){return t!==i}),v=d3.scaleTime().range([0,l]).domain(d3.extent(o,function(t){return t[i]})),b=d3.scaleLinear().range([d,0]).domain([0,m]),x=(d3.scaleOrdinal(d3.schemeAccent).domain(d3.keys(o[0]).filter(function(t){return t!==i})),d3.axisBottom().scale(v)),_=d3.axisLeft().scale(b),k=d3.area().x(function(t){return v(t.data.date)}).y0(function(t){return b(t[0])}).y1(function(t){return b(t[1])}),w=d3.stack().keys(y).order(d3.stackOrderNone).offset(d3.stackOffsetNone)(o),T=d3.stack().keys(y).order(d3.stackOrderNone).offset(d3.stackOffsetNone)(g),B=u.selectAll(".browser").data(w).enter().append("g").attr("class",function(t){return"browser "+t.key}).attr("fill-opacity",.5).append("path").attr("class","area").attr("d",k).style("fill","rgba(0,0,0,0.1)").style("stroke","#555").style("stroke-width","0.1").on("mouseover",function(t){d3.select(this).style("fill","#1e3791"),M.attr("transform","translate(".concat(d3.mouse(this)[0],",").concat(d3.mouse(this)[1],")")).text(t.key).style("display","block")}).on("mousemove",function(t){M.attr("dx",d3.mouse(this)[0]<l/2?10:-10).attr("text-anchor",d3.mouse(this)[0]<l/2?"start":"end").attr("transform","translate(".concat(d3.mouse(this)[0],",").concat(d3.mouse(this)[1],")"))}).on("mouseout",function(){d3.select(this).style("fill","rgba(0,0,0,0.1)"),M.style("display","none")});u.append("g").attr("class","x axis").attr("transform","translate(0,"+d+")").call(x),u.append("g").attr("class","y axis").call(_),u.append("text").attr("dx",10).attr("dy",15).text("Downloads").style("font-family","sans-serif").style("font-size",10);var M=u.append("text").attr("dy",6).style("text-shadow","0px 0px 3px #fff").style("fill","#000").style("font-weight","bold").style("pointer-events","none").style("font-family","sans-serif").style("font-size",10).style("text-transform","capitalize"),A=!0;return e.setMode=function(t){A=t},e.mode=function(){return A},e.update=function(){B.datum(function(t,e){return A?w[e]:T[e]}).transition().attr("d",k)},e.svg=function(){return s},e.g=function(){return u},e.dHeight=function(){return d},e.dWidth=function(){return l},e},histoline=function(t){var e=t.container||d3.select("body"),a=t.height||250,n=t.width||500,r=t.data,o=t.data_column||"value",i=(t.zero_based,t.colors,e.append("svg").attr("width",n).attr("height",a).attr("viewBox","0 0 ".concat(n," ").concat(a)).attr("preserveAspectRatio","xMidYMid meet")),s=t.margin||{top:20,right:20,bottom:30,left:50},c=n-s.left-s.right,l=a-s.top-s.bottom,d=i.append("g").attr("transform","translate(".concat(s.left,",").concat(s.top,")")),u=t.parseTime||d3.timeParse("%Y-%m-%d"),p=t.isTime||!1,h=[];r.forEach(function(t){"NaN"!=t[o]&&(p?h.push(u(t[o])):h.push(+t[o]))});var f=d3.scaleLinear().domain(d3.extent(h)).nice().range([0,c]),m=d3.max(h)-d3.min(h),g=d3.histogram().thresholds(m)(h),y=d3.min(h);g.forEach(function(t,e){t.v=e+y}),g.slice(m,g.length-m),g=g.filter(function(t){return t.length>0});var v=d3.line().x(function(t){return f(t.v)}).y(function(t,e){return b(t.length)}),b=d3.scaleLinear().domain([0,d3.max(g,function(t){return t.length})]).nice().range([l,0]);return d.append("g").call(d3.axisLeft(b)).call(function(t){return t.select(".domain").remove()}).call(function(t){return t.selectAll(".tick line").attr("x1",c).style("stroke","rgba(0,0,0,0.1)")}).call(function(t){return t.select(".tick:last-of-type text").clone().attr("x",4).attr("text-anchor","start").attr("font-weight","bold").text(r.y)}),d.append("g").attr("transform","translate(0,".concat(l,")")).call(d3.axisBottom(f)),d.append("g").append("path").attr("fill","transparent").attr("stroke","red").attr("d",v(g)),{}},heatgrid=function(t){var e=t.container||d3.select("body"),a=t.height||250,n=t.width||500,r=t.data,o=t.date_column||"date",i=t.data_column||"value",s=t.zero_based||!1,c=(t.group_column,t.colors||["rgba(255,255,255,1)","rgba(0,0,0,1)"]),l=e.append("svg").attr("width",n).attr("height",a).attr("viewBox","0 0 ".concat(n," ").concat(a)).attr("preserveAspectRatio","xMidYMid meet"),d=t.margin||{top:20,right:20,bottom:30,left:50},u=n-d.left-d.right,p=a-d.top-d.bottom,h=l.append("g").attr("transform","translate(".concat(d.left,",").concat(d.top,")")),f=t.parseTime||d3.timeParse("%Y-%m-%d"),m=t.isTime||!1;r.forEach(function(t){t[o]=m?f(t[o]):+t[o],t[i]=+t[i]});var g=t.cols||10,y=t.rows||10,v=t.x||1==m?d3.scaleTime().rangeRound([0,g-1]).domain(d3.extent(r,function(t){return t[o]})):d3.scaleLinear().rangeRound([0,g-1]).domain(d3.extent(r,function(t){return t[o]})),b=t.y||d3.scaleLinear().rangeRound([y-1,0]).domain(s?[0,d3.max(r,function(t){return t[i]})]:d3.extent(r,function(t){return t[i]})),x=u/g,_=p/y,k=t.x||1==m?d3.scaleTime().rangeRound([0,u-x]).domain(d3.extent(r,function(t){return t[o]})):d3.scaleLinear().range([0,u-x]).domain(d3.extent(r,function(t){return t[o]})),w=t.y||d3.scaleLinear().rangeRound([p,0]).domain(s?[0,d3.max(r,function(t){return t[i]})]:d3.extent(r,function(t){return t[i]})),T={};r.forEach(function(t){var e=v(t[o]),a=b(t[i]);e in T||(T[e]={}),a in T[e]||(T[e][a]=0),T[e][a]++});var B=[];for(var M in T)for(var A in T[M])B.push({x:M,y:A,c:T[M][A]});var L=d3.scaleLinear().domain([0,d3.max(B,function(t){return t.c})]).range([c[0],c[1]]);return h.append("g").attr("transform","translate(".concat(x/2,",").concat(p,")")).call(d3.axisBottom(k)),h.append("g").call(d3.axisLeft(w)),h.append("g").selectAll("rect").data(B).enter().append("rect").attr("width",x).attr("height",_).attr("x",function(t){return t.x*x}).attr("y",function(t){return t.y*_}).attr("fill",function(t){return L(t.c)}),{}};d3.csv("../output/charts/all.csv").then(function(t){var e=lineChart({container:d3.select("#introvis"),data:t,yLabel:"Downloads",isTime:!0,zero_based:!0,group_column:"type",width:500,height:250,group_sort:["pv","a_pv","r_pv","ra_pv","ora_pv"],colors:{pv:"rgba(0,0,0,0.25)",a_pv:"rgba(0,0,0,0.5)",r_pv:"rgba(0,0,0,0.75)",ra_pv:"rgba(0,0,0,1)",ora_pv:"rgba(255,0,0,1)"}}),a=[{y:30,dy:20,date:"2013-04-01",note:{title:"VBB Data"}},{y:30,dy:20,date:"2013-09-01",note:{title:"Election 2013"}},{y:30,dy:20,date:"2017-03-01",note:{title:"Favourite first names"}},{y:30,dy:20,date:"2017-09-01",note:{title:"Election 2017"}}];a.forEach(function(t){t.x=e.x(e.parseTime(t.date)),t.x>e.dWidth()/2?t.dx=-50:t.dx=50,t.annotation=e.g().append("g").attr("class","annotation-group").call(d3.annotation().notePadding(5).type(d3.annotationCalloutElbow).annotations([t])).style("display","none")});var n=e.g().append("g").selectAll("line").data(a).enter().append("line").attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",0).attr("y2",e.dHeight()).attr("stroke","red").attr("stroke-dasharray","5,5"),r=[{title:"Downloads",copy:"The line chart on left shows downloads of data sets in Berlin's OpenData portal since April 2013.<br /><br />Click continue to learn more."},{title:"Internal data",copy:"While analysing the data, we identified a lot of data sets which are no longer accessible or which do not exist at all. For our analysis here, we are only using data that is still available in the portal, because we cannot access any meta data for datasets that no longer exist."},{title:"Tests",copy:"On closer inspection, we found out that a few downloads happen before the data sets are even published. This is probably due to administrators testing whether files were uploaded correctly."},{title:"Outliers",copy:"At first glance, it's obvious that there are multiple outliers."},{title:"VBB Data",copy:"In April 2013, the VBB published their timetables and routes under a CreativeCommons license. During this first month, those data sets were very popular. Today, the VBB offers an API, which is why the VBB data sets are less popular nowadays."},{title:"Elections",copy:"During elections, the download numbers rise. Datasets for election districts are of particular interest during these times."},{title:"Favourite first names",copy:"A beloved press story every year is that of the most popular first names among babies born in Berlin. Newspapers use this data to publish a lot of graphs and maps."},{title:"Cleaned data",copy:"For enable further analysis, we remove the peaks from the data. Otherwise, they would make it hard to detect other kinds of patterns in the data."}],o=0,i=function(){d3.select("#introtitle").html(r[o].title),d3.select("#introcopy").html(r[o].copy),e.svg().selectAll(".path").style("display","none"),a.forEach(function(t){t.annotation.style("display","none")});var t=["pv"];switch(o){case 0:n.style("display","none");break;case 1:t=["pv","a_pv"];break;case 2:n.style("display","none"),t=["pv","a_pv","ra_pv"];break;case 3:n.style("display","block"),t=["pv","a_pv","ra_pv"];break;case 4:t=["pv","a_pv","ra_pv"],a[0].annotation.style("display","block");break;case 5:t=["pv","a_pv","ra_pv"],a[1].annotation.style("display","block"),a[3].annotation.style("display","block");break;case 6:t=["pv","a_pv","ra_pv"],a[2].annotation.style("display","block");break;case 7:t=["pv","a_pv","ra_pv","ora_pv"]}e.svg().selectAll("#path_"+t.join(", #path_")).style("display","block"),d3.select("#introprev").property("disabled",0==o),d3.select("#intronext").property("disabled",o==r.length-1)};d3.select("#intronext").on("click",function(){o<r.length-1&&(o++,i())}),d3.select("#introprev").on("click",function(){o>0&&(o--,i())}),i()}).catch(function(t){throw t}),d3.json("../output/charts/outlier.json").then(function(t){t.forEach(function(t){"Liste der häufigen Vornamen 2016"===t.title&&(t.title="List of the most common first names 2016"),"Geometrien der Wahlbezirke für die Bundestagswahl in Berlin 2017"===t.title&&(t.title="Geometries of Berlin voting districts for the federal election in 2017"),"VBB-Fahrplan 2013"===t.title&&(t.title="VBB Schedule 2013"),"Wahllokale zur Bundestagswahl 2013 in Berlin"===t.title&&(t.title="Berlin polling locations for the 2013 federal election");var e=d3.select("#outliers").append("div");e.append("h3").attr("class","p-top").text(t.title);var a="<strong>License</strong>: ".concat(t.license_title,"<br /><strong>Published on</strong>:").concat(t.date_released,"<br /><strong>Author</strong>:").concat(t.author,'<br /><a href="https://daten.berlin.de/datensaetze/').concat(t.page,'">Goto Dataset &raquo;</a>');e.append("p").attr("class","copy small-copy").html(a),lineChart({container:e,yLabel:"Downloads",xGrid:!0,yGrid:!0,data:t.original_pv,data_column:"c",isTime:!0,width:700,xTickNum:5,zero_based:!0,colors:"#000"})})}).catch(function(t){throw t}),d3.csv("../output/charts/bots.csv").then(function(t){t.forEach(function(t){t.value=100*t.value}),lineChart({container:d3.select("#timepatterns"),data:t,isTime:!0,width:700,yLabel:"Part of data sets with clicks in %",zero_based:!0,group_column:"type",colors:{req:"rgba(0,0,0,1)",reql:"rgba(0,0,0,0.5)"}})}).catch(function(t){throw t}),d3.csv("../output/charts/releases.csv").then(function(t){var e=lineChart({container:d3.select("#newdata"),data:t,yLabel:"New data sets",yGrid:!0,width:700,isTime:!0,zero_based:!0,y:d3.scaleLinear().rangeRound([200,0]).domain([0,100])});e.g().append("g").attr("class","annotation-group black").call(d3.annotation().notePadding(5).type(d3.annotationCalloutElbow).annotations([{note:{title:"19.2.2014",label:"403 new data sets"},x:e.x(e.parseTime("2014-02-19")),y:20,dx:20,dy:50}]))}).catch(function(t){throw t}),d3.csv("../output/charts/seasonal.csv").then(function(t){lineChart({container:d3.select("#seasonal"),data:t,yLabel:"Downloads rel. to year's max.",width:700,xGrid:!0,group_column:"year",date_column:"month",zero_based:!0,xTicks:function(t){return["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"][t]},colors:{2014:"rgba(0,0,0,0.25)",2015:"rgba(0,0,0,0.5)",2016:"rgba(0,0,0,0.75)",2017:"rgba(0,0,0,0.1)"}})}).catch(function(t){throw t}),d3.csv("../output/charts/overtime.csv").then(function(t){lineChart({container:d3.select("#individual"),data:t,group_column:"type",colors:"rgba(0,0,0,0.1)"}),heatgrid({container:d3.select("#individual"),data:t,rows:10,cols:24,zero_based:!0})}).catch(function(t){throw t}),d3.csv("../output/charts/histofull.csv").then(function(t){histodots({container:d3.select("#histograms-1"),data:t,data_column:"all"}),histodots({container:d3.select("#histograms-2"),data:t,data_column:"mean"}),histodots({container:d3.select("#histograms-3"),data:t,data_column:"median"})}).catch(function(t){throw t}),d3.select("#showhistos").on("click",function(){var t=d3.select("#individual-histograms"),e=d3.select("#showhistos");"block"==t.style("display")?(t.style("display","none"),e.text("Show the first 12 month of a data set in histograms")):(t.style("display","block"),e.text("Hide histograms"))}),d3.csv("../output/charts/histotime.csv").then(function(t){for(var e=[],a=0,n=function(n){e[n]=0,t.forEach(function(t){"NaN"!=t["t"+n+"_median"]&&e[n]++}),e[n]>a&&(a=e[n])},r=1;r<=12;r++)n(r);var o=function(n){var r=histogram({container:d3.select("#individual-histograms"),data:t,width:350,height:200,maxValue:160,maxLength:820,bins:20,equalize:function(t){return t/e[n]*a},data_column:"t".concat(n,"_").concat("median")});r.g().append("g").attr("transform","translate(".concat(r.dWidth(),",0)")).append("text").attr("text-anchor","end").text(n+" months after release").attr("dy",6).style("font-family","sans-serif").style("font-weight","bold").style("font-size",12)};for(r=1;r<=12;r++)o(r)}).catch(function(t){throw t}),d3.csv("../output/charts/group_author.csv").then(function(t){var e=stackedArea({container:d3.select("#stacked_groups_2"),data:t,isTime:!0,height:600,width:700});d3.select("#stacked_groups_2-abs").on("click",function(){e.setMode(!0),e.update()}),d3.select("#stacked_groups_2-rel").on("click",function(){e.setMode(!1),e.update()})}).catch(function(t){throw t}),d3.csv("../output/charts/group_group_name_en.csv").then(function(t){var e=stackedArea({container:d3.select("#stacked_groups_1"),data:t,isTime:!0,height:600,width:700});d3.select("#stacked_groups_1-abs").on("click",function(){e.setMode(!0),e.update()}),d3.select("#stacked_groups_1-rel").on("click",function(){e.setMode(!1),e.update()})}).catch(function(t){throw t}),d3.csv("../output/charts/group_license_title.csv").then(function(t){var e=stackedArea({container:d3.select("#stacked_groups_3"),data:t,isTime:!0,height:600,width:700});d3.select("#stacked_groups_3-abs").on("click",function(){e.setMode(!0),e.update()}),d3.select("#stacked_groups_3-rel").on("click",function(){e.setMode(!1),e.update()})}).catch(function(t){throw t});var buildTable=function(t,e){var a=d3.select("#"+e).append("table"),n=a.append("thead").append("tr"),r=a.append("tbody").selectAll("tr").data(t).enter().append("tr");n.append("th").text("Dataset"),n.append("th").text("Downloads"),r.append("td").html(function(t){return"group"in t?'<strong><a href="https://daten.berlin.de/datensaetze/'.concat(t.page,'">').concat(t.page,'</a></strong><br /><span class="small">').concat(t.group,"</span>"):'<a href="https://daten.berlin.de/datensaetze/'.concat(t.page,'">').concat(t.page,"</a>")}),r.append("td").html(function(t){return"<strong>".concat(Math.round(t.count),"</strong>")})};d3.csv("../output/charts/top_abs.csv").then(function(t){buildTable(t,"top_abs")}).catch(function(t){throw t}),d3.csv("../output/charts/top_month.csv").then(function(t){buildTable(t,"top_month")}).catch(function(t){throw t}),d3.csv("../output/charts/top_group_abs.csv").then(function(t){buildTable(t,"top_group_abs")}).catch(function(t){throw t}),d3.csv("../output/charts/top_group_month.csv").then(function(t){buildTable(t,"top_group_month")}).catch(function(t){throw t});
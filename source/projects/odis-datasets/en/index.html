---
layout: post
description: ""
lang: en
title: Core data sets
subtitle: An overview about the most important datasets of Berlin
type: publication
colorMode: bright
featuredImage: /projects/odis-datasets/images/featured.jpg
thumbnail: /projects/odis-datasets/images/thumbnail.jpg
heroImage: /projects/odis-datasets/images/hero.jpg
socialMediaImage: /assets/images/social_media.jpg
visible: false
featured: false
authors:
  - fabian-dinklage
start: 2019-07-03
end: 2019-07-03
status: finished
date: 2019-07-03
assets:
  js:
    - "../js/index.js"
  css:
    - "../css/index.css"
materialsIncluded:
  - name: images
    link: "#"
  - name: video
    link: "#"
  - name: press text
    link: "#"
  - name: Source Code
    link: "#"
redirect_from:

---

<!-- Todos: 

- Content einsetzen
- Content übersetzen

-->

<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
	<script src="https://kryogenix.org/code/browser/sorttable/sorttable.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.7/d3.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"></script>
</head>

<main class="project project--{{ page.type }}"  markdown="1">
	<section class="mission-statement">
		<div class="html-content">
			<h1 class="section-headline">Berlin’s Core Datasets</h1>
			<p>The Berlin city administration possesses a treasure trove of potentially valuable data. The city’s E-Government Law (passed in 2016) stipulates that the government and all of its associated departments and agencies are obligated to make their data available as machine-readable open data. But often the question remains: where exactly should government entities start with open data?
			</p>

			<p>In order to bring open data from theory into practice as well as to better demonstrate the value of open data, it can be extremely helpful to first set priorities – which are the datasets that the city most needs as open data? While Berlin has been publishing open data for several years, this is still a question we hear posed often. Thus, we created this list of “core” datasets for Berlin, which contains the datasets we believe offer the city and its inhabitants the greatest possible value. 
			</p>

			<h2 class="subHeadline">About the core datasets table</h2>

			<p class="small">The below table contains 100 datasets that we identified as being particularly valuable for Berlin when published as open data. We evaluated these datasets based on their potential reuse for the research, business, and civil society sectors; the possible efficiency gains for the government as a result of publishing these datasets; and the contribution of these datasets toward building a more transparent and democratic society. For a more complete explanation of how we assembled this list, see the accompanying publication we released with this project. 
			</p>

			<p class="small">Rating individual datasets based on these five criteria allowed us to create a total score for each dataset that captured its potential; this is displayed in the table under the <b>“Score”</b> column. We also assessed the availability of individual datasets as machine-readable, open data; the results of this assessment are displayed in the <b>“Availability”</b> column. The scale is structured as follows:
			</p>

			<p class="small">0: The data either does not exist or its status is unknown				<br>
				1: The data exists, but it’s not publicly accessible in any form <br>
				2: The data is publicly accessible but not machine-readable 				<br>
				3: The data is machine readable but has limitations (such as insufficient quality or granularity)<br>
				4: The data is available as fully open and high-quality data<br>				
			</p>

			<p class="small">For the cases where a source for the data (or at least, information about the data) was known, the corresponding link is included in the <b>“Link”</b> column. 
			</p>

			<p class="small">Important to note: We chose these 100 datasets because we evaluated them to present the greatest potential value for the largest number of people. There are, of course, many more datasets that perhaps have more narrow appeal, but which nevertheless should be published as open data. The goal of this list was not to cover all datasets, but simply those with the largest potential. We are highly interested in feedback on this list, as well as a lively discussion on the role that open data can play in Berlin. 
			</p>

			<p class="small">Has the availability of a certain dataset changed, or is one of our links outdated? Or, do you feel like a critical dataset is missing from this list? Feel free to send corrections and comments to <a href="mailto: dykes@technologiestiftung-berlin.de"> dykes@technologiestiftung-berlin.de</a>. 
			</p>
			

			<div class="table-legend--wrapper">
				<span class="title">Data availability</span>
				<div class="table-legend" id="table-legend">
				</div>
			</div>

		</div>
	</section>
	<section class="html-content">
		<table style="width:100%" id="data-table"></table>
	</section>

	<div class="tooltip-wrapper"></div>

</main>

<script>
	const sheet = "https://spreadsheets.google.com/feeds/list/1a4TvQ7jSGCoWnSPMKUoLo5LepSXLXFY-6t7PiKLQaSI/od6/public/values?alt=json";
	const table = d3.select('#data-table');
	const tableNode = document.getElementById('data-table')
	let tableHead, tableBody, bodyWidth;
	let lang = 'en'
	

	const dict = {
		'de': [
			{'head': 'Datensatz'},
			{'head': 'Beschreibung'},
			{'head': 'Kategorie'},
			{'head': 'Score'},
			{'head': 'Zugang'},
			{'head': 'Link'}
		],
		'en': [
			{'head': 'Dataset'},
			{'head': 'Description'},
			{'head': 'Category'},
			{'head': 'Score'},
			{'head': 'Availability'},
			{'head': 'Link'}
		],
	}

	const dictTooltip = {
		'de': {
			'Score': {
				'title': "Bewertung",
				'lines': ['Min: 5, Max: 15']
			},
			'Availability': {
				'title': "Zugänglichkeit",
				'lines': ["0: nicht vorhanden/unbekannt", "1: vorhanden, aber nicht öffentlich", "2: öffentlich aber nicht maschinenlesbar", "3: maschinenlesbar mit Einschränkungen", "4: Open Data konform"]
			}
		},
		'en': {
			'Score': {
				'title': "Score",
				'lines': ['Min: 5, Max: 15']
			},
			'Availability': {
				'title': "Access",
				'lines': ["0: Non-existent/Unknown", "1: Closed data", "2: Non-machine-readable data", "3: Machine-readable data with limitations", "4: Fully Open Data"]
			}
		}
	}

	const colors = ['#ED745E', '#ED9A5E', '#EDE15E', '#C8D66A', '#87C76C'];

	function setColumns() {
		tableHead = table.append('tr');

		let dictMobile = [];

		dictMobile.push(dict[lang][0])
		dictMobile.push(dict[lang][3])
		dictMobile.push(dict[lang][4])
		dictMobile.push(dict[lang][5])

		let dictCurrent = bodyWidth > 1000 ? dict[lang] : dictMobile;

		tableHead.selectAll('th')
			.data(dictCurrent)
			.enter()
			.append('th')
			.attr('id', function(d) { return d.head })
			.append('span')
			.classed('th-title', true)
			.text(function(d) { return d.head })
	}

	function toggleTooltip(id = null, row = null) {
		let tooltip = d3.select('.tooltip-wrapper')
		// let label = d3.select(`#${id}`);

		tooltip.classed('active', true);

		d3.selectAll('.tooltipLine').remove()
		d3.selectAll('.tooltipTitle').remove()
		d3.selectAll('.tooltipSpan').remove()

		if (id != 0 && row != 0) {
			// console.log(id, row);

			tooltip.append('span')
				.classed('tooltipLine', true)
				.text(`Value for businesses: ${row['gsx$valueforbusinesses1-3'].$t}`)


			tooltip.append('span')
				.classed('tooltipLine', true)
				.text(`Value for civil society: ${row['gsx$valueforcivilsociety1-3'].$t}`)

			tooltip.append('span')
				.classed('tooltipLine', true)
				.text(`Value for research: ${row['gsx$valueforresearch1-3'].$t}`)

			tooltip.append('span')
				.classed('tooltipLine', true)
				.text(`Government efficiency: ${row['gsx$possiblegovernmentefficiencygains1-3'].$t}`)


			tooltip.append('span')
				.classed('tooltipLine', true)
				.text(`Transparency relevance: ${row['gsx$relevancefortransparency1-3'].$t}`)

		} else {
			console.log(id, row);
			tooltip.append('span')
				.classed('tooltipTitle', true)
				.text(dictTooltip[lang][id.head].title)
	
			dictTooltip[lang][id.head].lines.forEach(function(line) {
				tooltip.append('span')
					.classed('tooltipLine', true)
					.text(line)
			})
	
		}

		let tooltipHeight = tooltip.node().clientHeight
		let tooltipWidth = tooltip.node().clientWidth
	
		tooltip
			.attr('style', `top: ${d3.event.pageY - tooltipHeight - 30}px; left: ${d3.event.pageX - (tooltipWidth / 2)}px`)
		

	}

	function handleMouseOut(d,i,n) {
		let tooltip = d3.select('.tooltip-wrapper')
		tooltip.classed('active', false);
	}

	function addTooltipLabel(id) {
		let tooltipLabelWrapper = d3.select(`#${id}`).append('div')
			.classed('tooltip-btn', true)
			.on('mouseover', toggleTooltip)
			.on('mouseout', handleMouseOut)

		tooltipLabelWrapper.append('span')
			.text('i')
	}

	function tableLegend() {
		const tableWrapper = d3.select('#table-legend')

		tableWrapper.append('span')
			.classed('legend-label', true)
			.text('Very low')

		colors.forEach(function (color) {
			tableWrapper.append('div')
				.classed('legend-dot', true)
				.style('background-color', color)
		})

		tableWrapper.append('span')
			.classed('legend-label', true)
			.text('Very high')
	}

	function injectData(dataArray) {

		tableBody = table.append('tbody');

		dataArray.forEach(function (row, index) {

			let tableRow = tableBody.append('tr');

			tableRow.append('td')
				.text(row.gsx$dataset.$t)
				.style('font-weight', 'bold')

			if (bodyWidth > 1000) {
				tableRow.append('td')
					.text(row.gsx$description.$t)
	
				tableRow.append('td')
					.text(row.gsx$category.$t)
			}


			tableRow.append('td')
				.style('text-align', 'center')
				.attr('id', `id-${index}`)
				.classed('score-td', true)
				.text(row.gsx$totalscore.$t)
				.on('mouseover', () => { return toggleTooltip(`id-${index}`, row) })
				.on('mouseout', handleMouseOut)
				
			let scoreCell = tableRow.append('td')
				
			let colorDotDiv = scoreCell.append('div')
				.attr('class', 'color-dot')
				.style('background', colors[parseInt(row.gsx$availability.$t)])

			colorDotDiv.append('span')
				.text(row.gsx$availability.$t)

			let linkRow = tableRow.append('td')

			if (row.gsx$link.$t.length > 0) {

				linkRow.append('a')
					.classed('file', true)
					.attr('href', row.gsx$link.$t)
					.attr('target', '_blank')
					
			} else {
				linkRow.append('a')
			}

		})
	}


	axios.get(sheet).then(function(res) {
		const data = res.data.feed.entry;

		bodyWidth = d3.select('body').node().getBoundingClientRect().width;

		console.log(data[0])

		setColumns(data[0])
		injectData(data);	
		tableLegend();

		if (bodyWidth > 499) {
			addTooltipLabel('Score');
			addTooltipLabel('Availability');
		}

		sorttable.makeSortable(tableNode)
	})
	.catch(function(e) {
		console.log(e);
	})
</script>

<style>
	table#data-table  {
		border-collapse: collapse;
		white-space: normal!important;
	}
	
	tr { 
		border: solid #e8e8e8;
		border-width: 1px 0;
		line-height: 140%;
	}

	th {
		cursor: pointer;
	}

	th#Score {
		width: 95px;
	}

	td.score-td {
		cursor: pointer;
	}

	th#Access {
		width: 95px;
	}

	td {
		padding: 12px 0px;
		position: relative;
		word-wrap: break-word;

	}

	td:first-of-type {
		padding: 15px 20px 15px 0;
		max-width: 200px;
		min-width: 150px;
	}

	tr:first-of-type {
		border-width: 0px 0;
	}

	.color-dot {
		width: 30px;
		height: 30px;
		border-radius: 100px;
		position: absolute;
		top: calc(50% - 15px);
		left: 10px;
		z-index: -1;
		display: flex;
    	justify-content: center;
	}

	.color-dot span {
		transform: translateY(3px);
	}

	a.file {
		background: url(../images/file.svg);
		background-size: 20px 25px;
		display: block;
		text-indent: -9999px;
		width: 20px;
		cursor: pointer;
		height: 25px;
		color: #FFFFFF;
		text-decoration: none;
		border-bottom: none !important;
	}

	.table-legend--wrapper {
		margin: 0 12vw 30px 12vw;
	}

	.table-legend--wrapper > span {
		font-size: 20px;
		font-weight: bold;
	}

	.table-legend {
		display: flex;
		flex-direction: row;
		margin-top: 10px;
	}

	.legend-dot {
		margin-right: 10px;
		width: 20px;
		height: 20px;
		border-radius: 100px;
	}

	.legend-dot:first-of-type {
		margin-left: 10px;
	}

	section.mission-statement h2.subHeadline {
		font-size: 20px !important;
		margin-bottom: 0 !important;
		line-height: 1.4em;
		font-weight: bold;
	}

	section.mission-statement p.small {
		font-size: 16px;
		line-height: 1.6em;
	}


	@media only screen and (max-width: 768px) {
		.table-legend--wrapper {
			margin: 0 0 30px 0;
		}

		section.mission-statement h2.subHeadline {
			font-size: 20px !important;
			margin-bottom: 10px !important;
			font-weight: bold;
			line-height: 1.4em;
		}
	}

	th#category {
		min-width: 250px;
	}

	th#Availability {
		min-width: 150px;
	}

	th#Link {
		min-width: 50px;
	}

	.tooltip-btn {
		width: 22px;
		height: 22px;
		background: white;
		color: black;
		position: relative;
		border-radius: 3px;
		border: 1px solid black;
		transition: all .125s ease;
		float: left;
		margin-left: 7px;
	}

	.tooltip-btn span {
		position: absolute;
		font-weight: normal;
		left: 8px;
		top: -1px;
	}

	.tooltip-btn:hover {
		background: black;
		color: white;
		transition: all .125s ease;
	}

	.tooltip-wrapper {
		width: 320px;
		height: auto;
		position: absolute;
		display: none;
		flex-direction: column;
		padding: 12px 14px 12px 14px !important;
		border: 1px solid #e8e8e8 !important;
		background: white;
		z-index: 100;
		opacity: 0;
		transition: all .125s ease;
	}

	.active {
		display: flex;
		opacity: 1;
		transform: translateY(-5px);
		transition: all .125s ease;
	}

	span.tooltipLine {
		margin-bottom: 5px;
	}

	.th-title {
		float: left;
	}

	.tooltipTitle {
		font-weight: bold;
		margin-bottom: 10px;
	}

	@media screen and (max-width: 1024px) {
		.table-legend--wrapper {
			margin: 0 5vw 30px 5vw;
		}
	}

	@media screen and (max-width: 768px) {
		.table-legend--wrapper {
			margin: 0 0 30px 0;
		}
	}

	@media screen and (max-width: 400px) {
		.table-legend--wrapper {
			margin: 0 5vw 30px 0;
		}

		table {
			font-size: 12px !important;
		}
		td:first-of-type {
			max-width: 150px;
		}

		.color-dot {
			top: calc(50% - 11px);
		}

		.color-dot span {
			transform: translateY(3px);
		}

		.color-dot {
			width: 20px;
			height: 20px;
		}

		.legend-dot {
			width: 18px;
			height: 18px;
		}

		.legend-label {
			font-size: 12px;
			padding-top: 2px;
		}


		a.file {
			background: url(../images/file.svg);
			background-size: 15px 25px;
			display: block;
			text-indent: -9999px;
			width: 15px;
			cursor: pointer;
			height: 25px;
			color: #FFFFFF;
			text-decoration: none;
			border-bottom: none !important;
		}

		.legend-dot {
			height: 18px;
		}
	}

</style>

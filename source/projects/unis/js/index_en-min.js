"use strict";var map_chart,bee_chart,tool_tip,table_ranking,brushed_tool_tip,map_chart_berlin,map_chart_berlin_legend,bee_chart_berlin,berlinStudents,berlinStudies,berlinAge,cell,rankedByAge,studentsSubheadline,tool_tip_berlin,brushed_tool_tip_berlin,tableItem,tableContent,tableItemValue,brush_extent,sumStudentsPercent,map_chart_legend,rankedByStudents,rankedByStudies,filterDefault,unis_berlin,typeGlobal,filterSwitch="students",order="ascending",zoomTimer=3;navigator.userAgent.match(/AppleWebKit/)&&!navigator.userAgent.match(/Chrome/)&&document&&(document.body.className+=" safari");var dataGlobal,rangeMin=1,rangeMax=600,initScale={scale:5e4,x:-312.30765033408386,y:3576.511912314453},filterKey="count_students",domain=[24,68429],scale=d3.scaleLinear().domain([domain[0],domain[1]]).range([rangeMin,rangeMax]),tau=2*Math.PI,projGer=d3.geoMercator().scale(1/tau).translate([0,0]),projBerlin=d3.geoMercator().scale(1/tau).translate([0,0]),colors=["F67060","F39072","E5CB98","D0CEA5","B0BAAA","6892B1","8FA6AE"],invertedColors=["F67060","8FA6AE","6892B1","B0BAAA","D0CEA5","E5CB98","F39072"],colorScale=d3.scaleQuantize().domain([domain[0],domain[1]]).range(colors),colorScaleInverted=d3.scaleQuantize().domain([domain[0],domain[1]]).range(invertedColors),calcArea=function(t){return Math.sqrt(t/Math.PI)},update=function(t,e){if("GER"==e){var n=dataGlobal.filter(function(e){return e.count_students<t[0]&&e.count_students>t[1]});bee_chart.update(t),map_chart.update(t),brushed_tool_tip.update(n)}else if("BER"==e){var a=unis_berlin.filter(function(e){return e.count_students<t[0]&&e.count_students>t[1]});bee_chart_berlin.update(t),map_chart_berlin.update(t),brushed_tool_tip_berlin.update(a)}},updateTooltip=function(t,e){"bee"==e?(tool_tip.update(t.datum),tool_tip_berlin.update(t.datum)):"map"==e&&(tool_tip.update(t),tool_tip_berlin.update(t))},filterData=function(t,e){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"descending";"ascending"==a?n=e.sort(function(e,n){return e[t]>n[t]?1:e[t]<n[t]?-1:e[t]==n[t]?e.name>n.name?1:e.name<n.name?-1:0:0}):"descending"==a&&(n=e.sort(function(e,n){return e[t]>n[t]?-1:e[t]<n[t]?1:e[t]==n[t]?e.name>n.name?-1:e.name<n.name?1:0:0}));for(var r=[],i=0;i<10;i++){var l=n[i];r.push(l)}return r},rankedData=function(t,e){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"descending";"ascending"==a?n=e.sort(function(e,n){if(e[t]>n[t])return 1;if(e[t]<n[t])return-1;if(e[t]==n[t]){if(e.name>n.name)return 1;if(e[t]<n[t])return-1}}):"descending"==a&&(n=e.sort(function(e,n){if(e[t]>n[t])return-1;if(e[t]<n[t])return 1;if(e[t]==n[t]){if(e.name>n.name)return-1;if(e[t]<n[t])return 1}}));for(var r={count_students:"rStudents",count_studies:"rStudies",year:"rAge"},i=[],l=0;l<e.length;l++){var s=n[l];s[r[t]]=l+1,i.push(s)}return i};getBerlinUnis=function(t){var e=[];return t.forEach(function(t,n){"Berlin"==t.county&&e.push(t)}),e};var mapChart=function(t,e,n,a,r,i,l){var s,c,d,o,u,p,f,b,h,m,v,g,_,y={},x=i,S=t,A=l,B=e,k=r,E=a,w=[];return h=k.append("div").attr("class","overlay-boarding-map").attr("width",200).attr("height",200),pointer=h.append("img").attr("src","../images/zoom.png").attr("width",54).attr("height",54),hint=h.append("p").attr("class","hint"),hint.text("Change the image section by scrolling."),"BER"==A?g=x([13.42,52.51]):"GER"==A&&(g=x([10.32,50.91])),d=d3.zoom().on("zoom",function(t){!function(){var t={scale:d3.event.transform.k,x:d3.event.transform.x,y:d3.event.transform.y},e="BER"==A?t.scale>35e4:t.scale>6e4,n=("translate(".concat(t.x,",").concat(t.y,") scale(").concat(t.scale,")"),document.getElementsByClassName("map-unis-germany")),a=document.getElementsByClassName("map-unis-berlin");t.scale>5e4&&"GER"==A?n[0].childNodes[0].childNodes[2].childNodes[0].classList.add("hide"):t.scale<4e4&&"GER"==A&&n[0].childNodes[0].childNodes[2].childNodes[0].classList.remove("hide");t.scale>35e4&&"BER"==A?a[0].childNodes[0].childNodes[2].childNodes[0].classList.add("hide"):t.scale<2e5&&"BER"==A&&a[0].childNodes[0].childNodes[2].childNodes[0].classList.remove("hide");if(x.scale(t.scale/tau).translate([t.x,t.y]),path=d3.geoPath().projection(x),b=f.scale(t.scale).translate([t.x,t.y])(),(m=v.attr("transform",function(t,e){var n=t/256,a=t%1?Number:Math.round;return"translate("+a(e[0]*t)+","+a(e[1]*t)+") scale("+n+")"}(b.scale,b.translate)).selectAll("image").data(b,function(t){return t})).exit().remove(),"BER"==A)d3.selectAll("circle__wrapper--circle-ber");else if("GER"==A)d3.selectAll("circle__wrapper--circle-ger");c.attr("cx",function(t){return t[E]?x([t.lng,t.lat])[0]:"1px"}).attr("cy",function(t){if(t[E])return x([t.lng,t.lat])[1]}).attr("r",function(t){return calcArea(1.5*s(t.count_students))}),_.attr("d",path),e&&m.enter().append("image").attr("xlink:href",function(t){return"http://"+"abc"[t[1]%3]+".tile.stamen.com/toner/"+t[2]+"/"+t[0]+"/"+t[1]+".png"}).attr("x",function(t){return 256*t[0]}).attr("y",function(t){return 256*t[1]}).attr("width",256).attr("height",256).style("opacity",.5)}(),(zoomTimer-=1)<=0&&(d3.selectAll(".overlay-boarding-map").attr("style","display: none"),d3.selectAll(".overlay-boarding-bee").attr("style","display: none"),d3.selectAll(".sub-wrapper").attr("style","display: flex"))}).scaleExtent([12288,6<<20]),o=k.append("svg").attr("width",500).attr("height",500).attr("stroke","#D3D3D3").attr("stroke-width","1px").attr("class",function(t){return"GER"==A?"map-unis-germany":"map-unis-berlin"}).attr("fill","#FFF"),f=d3.tile().size([500,500]),path=d3.geoPath().projection(x),(u=o.append("g")).append("rect").attr("width",2e3).attr("height",2e3).attr("transform","translate(-1000,-1000)"),v=u.append("g"),p=u.append("g").attr("class","svg-wrapper"),_=p.append("g").selectAll("path").data(topojson.feature(B,B.objects["germany-merged"]).features).enter().append("path").attr("class","contour").style("stroke","rgb(150,150,150)").style("fill","none").attr("d",path),d3.select("#reset").on("click",function(){u.transition().duration(500).call(d.transform,d3.zoomIdentity)}),y.init=function(){S.forEach(function(t){w.push(t.count_students)}),d3.extent(w),s=d3.scaleLinear().domain([24,68429]).range([1,4e3]),S.sort(function(t,e){return e.count_students-t.count_students}),c=p.selectAll("g.circle_wrapper").data(S).enter().append("g").attr("class","circle__wrapper").append("circle").attr("stroke-width","0px").attr("title",function(t){return t.name}).attr("id",function(t){return"map_".concat(t.id_hochschule)}).attr("class",function(t){}).attr("style",function(t){return"fill: #".concat(colorScale(t[E]),"; opacity: .4;")}).attr("r",function(t){return"".concat(calcArea(s(t.count_students)))}).attr("cx",function(t){return t[E]?x([t.lng,t.lat])[0]:"1px"}).attr("cy",function(t){if(t[E])return x([t.lng,t.lat])[1]}).on("mouseover",function(t){var e=d3.select(this).attr("id");if("BER"==A)d3.selectAll("circle__wrapper--circle-ber");else if("GER"==A)d3.selectAll("circle__wrapper--circle-ger");d3.selectAll(".sub-wrapper").attr("style","display: flex"),c.transition().duration(100).style("opacity",function(t){return"map_".concat(t.id_hochschule)==e?.8:.2}),updateTooltip(t,"map"),bee_chart.refresh(d3.select(this).attr("id"),"mouseover")}).on("mouseout",function(t){var e=d3.select(this).attr("id");c.transition().duration(100).style("opacity",function(t){return"map_".concat(t.id_hochschule)==e?.8:.4}),bee_chart.refresh(d3.select(this).attr("id"),"mouseout")}),"GER"==A?o.call(d).call(d.transform,d3.zoomIdentity.translate(250,250).scale(13e3).translate(-g[0],-g[1])):"BER"==A&&o.call(d).call(d.transform,d3.zoomIdentity.translate(250,250).scale(26e4).translate(-g[0],-g[1]))},y.scale=function(){return s=d3.scaleLinear().domain([24,68429]).range([1,4e3])},y.refresh=function(t,e){t=parseInt(t.slice(4,7));var n=d3.selectAll('circle[id="map_'.concat(t,'"]'));if("BER"==A)d3.selectAll("circle__wrapper--circle-ber");else if("GER"==A)d3.selectAll("circle__wrapper--circle-ger");"mouseover"==e?c.transition().duration(100).attr("style",function(t){return"fill: #".concat(colorScale(t[E]),"; opacity: .1;")}):c.transition().duration(100).attr("style",function(t){return"fill: #".concat(colorScale(t[E]),"; opacity: .2;")}),"mouseover"==e?n.transition().duration(100).attr("style",function(t){return"fill: #".concat(colorScale(t[E]),"; opacity: 1;")}):n.transition().duration(100).attr("style",function(t){return"fill: #".concat(colorScale(t[E]),"; opacity: .1;")})},y.update=function(t){if("BER"==A)d3.selectAll("circle__wrapper--circle-ber");else if("GER"==A)d3.selectAll("circle__wrapper--circle-ger");c.classed("selected--circles",function(e){var n=t[1]<=e[E]&&e[E]<=t[0];return d3.select(this).attr("style",function(t){return"fill: #".concat(colorScale(t[E]),";")}),n}),c.classed("unselected--circles",function(e){var n=e[E]<t[1]||e[E]>t[0],a=d3.select(this),r=this.getAttribute("y1");return a.attr("style",function(t){return"fill: #".concat(colorScale(t[E]),";")}),n?a.transition().attr("y2",function(t){return r-2}):n||a.transition().attr("y2",function(t){return r-s(t[E])}),n})},y},beeChart=function(t,e,n,a,r){var i,l,s,c,d,o={},u=r,p=20,f=25,b=430-p-40,h=a,m=n,v=t,g=d3.brushY(),_=[];(d=h.append("div").attr("class","overlay-boarding-bee").attr("width",200).attr("height",200)).append("img").attr("src","../images/pointer.png").attr("width",54).attr("height",54),d.append("p").attr("class","hint").text("Mark a vertical selection to select mupltiple universities."),l=h.append("svg").attr("width",500).attr("height",430).attr("id","bee"),s=l.append("g").attr("transform","translate("+f+","+p+")");var y=function(t){t.call(d3.axisLeft(c).ticks(5,".0s").tickSize(-500)),t.select(".domain").remove(),t.selectAll("line").style("stroke","#D8D8D8"),t.selectAll("text").style("font-family","ClanOT-Medium")};return s.append("g").attr("class","brush").call(g),g.on("brush",function(){if(d3.event.selection){var t=d3.event.selection.map(c.invert,c);d3.selectAll("rect").filter(":nth-child(2)").attr("fill-opacity",".075"),d3.selectAll(".overlay-boarding-bee").attr("style","display: none"),d3.selectAll(".overlay-boarding-map").attr("style","display: none"),d3.selectAll(".sub-wrapper").attr("style","display: flex"),brush_extent=t,update(t,u)}}),o.init=function(){v.forEach(function(t){_.push(t[m])}),extent=d3.extent(_),c=d3.scaleLinear().domain([extent[1],extent[0]]).range([0,b]),i=d3.beeswarm().data(v).distributeOn(function(t){return c(t[m])}).radius(3).orientation("vertical").side("positive").arrange(),s.append("g").attr("class","axis axis--y").attr("transform","translate(0,0)").call(y),(cell=s.append("g").attr("class","cells")).selectAll("circle").data(i).enter().append("circle").attr("class","dot").attr("id",function(t){return"GER"==u?"bee_".concat(t.datum.id_hochschule,"-ger"):"bee_".concat(t.datum.id_hochschule,"-ber")}).attr("cx",function(t){return t.x+20}).attr("cy",function(t){return t.y}).attr("r",2).attr("style",function(t){return"fill: #".concat(colorScale(t.datum[m]))}).on("mouseover",function(t){d3.select(this).transition().duration(100).attr("r","6px"),updateTooltip(t,"bee"),map_chart.refresh(d3.select(this).attr("id"),"mouseover")}).on("mouseout",function(t){d3.select(this).transition().duration(100).attr("r","2px"),map_chart.refresh(d3.select(this).attr("id"),"mouseout")})},o.refresh=function(t,e){t=parseInt(t.slice(4,7));var n="GER"==u?d3.selectAll('circle[id="bee_'.concat(t,'-ger"]')):d3.selectAll('circle[id="bee_'.concat(t,'-ber"]'));"mouseover"==e?n.transition().duration(100).attr("r","6px"):n.transition().duration(100).attr("r","2px")},o.update=function(t){var e=d3.selectAll(".dot");e.classed("selected--cells",function(e){return t[1]<=e.datum[m]&&e.datum[m]<=t[0]}),e.attr("r",function(e){return t[1]<=e.datum[m]&&e.datum[m]<=t[0]?3:2});cell.selectAll("circle")},o},brushedTooltip=function(t,e,n){var a,r,i,l,s,c,d,o,u,p,f,b,h,m,v={},g=e,_=n;return v.init=function(){r=(a=g).append("div").attr("class","tt-headline").text(""),b=a.append("div").attr("class","sub-wrapper"),(l=b.append("div").attr("class","tt-wrapper")).append("div").attr("class","tt-subheadline").text("ø Age"),i=l.append("div").attr("class","tt-value").text("Select area"),(s=b.append("div").attr("class","tt-wrapper")).append("div").text("Students").attr("class","tt-subheadline"),c=b.append("div").attr("class","tt-wrapper"),o=s.append("div").attr("class","tt-value").text("Select area"),m=l.append("div").attr("class","tt-subline").text("for more information"),h=s.append("div").attr("class","tt-subline").text("".concat(0,"% of 2.74 mio. students.")),c.append("div").attr("class","tt-subheadline").text("ø Studies"),f=c.append("div").attr("class","tt-value").text("Select area"),c.append("div").attr("class","tt-subline").text("of 2–350 studies.")},v.update=function(t){var e;"BER"==_?e=unis_berlin.length:"GER"==_&&(e=dataGlobal.length),d=0,u=0,p=0,t.forEach(function(t){d+=t.count_students,u+=2018-t.year,p+=t.count_studies}),p/=t.length,u/=t.length,sumStudentsPercent=100*round(d/267e4),m.text("of selected universities."),h.text("".concat(sumStudentsPercent,"% of 2.74 Mio. students.")),r.text("".concat(round(t.length)," of ").concat(e," universities selected.")),i.text(function(t){return"NaN"==round(u).toString().replace(".",",")?"No selection":"".concat(round(u).toString().replace(".",",")," years")}),o.text(function(t){var e=numberFormat(d);return"0"==e?"No selection":e}),f.text(function(t){return"NaN"==round(p).toString().replace(".",",")?"No selection":"".concat(round(p).toString().replace(".",","))})},v},tooltip=function(t,e){var n,a,r,i,l,s,c,d,o,u,p,f={},b=e;t[2];return f.init=function(){a=b.append("div").attr("class","tt-headline").text(""),n=b.append("div").attr("class","sub-wrapper"),r=n.append("div").attr("class","tt-wrapper"),i=n.append("div").attr("class","tt-wrapper"),l=n.append("div").attr("class","tt-wrapper"),r.append("div").attr("class","tt-subheadline").text("Founded"),s=r.append("div").attr("class","tt-value").text("Select university"),c=r.append("div").attr("class","tt-subline").text("for more information"),studentsSubheadline=i.append("div").attr("class","tt-subheadline").text("Students"),d=i.append("div").attr("class","tt-value").text("Select university"),o=i.append("div").attr("class","tt-subline").text("for more information"),l.append("div").attr("class","tt-subheadline").text("Studies"),u=l.append("div").attr("class","tt-value").text("Select university"),p=l.append("div").attr("class","tt-subline").text("#".concat(12," of 374"))},f.update=function(t){a.text(t.name),s.text(t.year),d.text(numberFormat(t.count_students)),u.text(t.count_studies),c.text("#".concat(t.rAge," of 374")),o.text("#".concat(t.rStudents," of 374")),p.text("#".concat(t.rStudies," of 374"));for(var e=document.getElementsByClassName("tt-headline"),n=0;n<e.length;n++){var r=e[n];r.innerHTML=r.innerHTML.substring(0,75)}},f},legend=function(t){var e,n={},a=t;return n.init=function(){for(var t=0;t<7;t++){var n=1e4*(t+1);(e=a.append("div").attr("class","bar-wrapper")).append("div").attr("class","bar").attr("style","background: #".concat(colorScaleInverted(n))),e.append("span").attr("class","bar-metadata").text("".concat(7-t,"0.000"))}},n},table=function(){var t,e,n,a,r,i,l,s={};return s.init=function(){t=d3.select("#table-wrapper"),e=t.append("div").attr("class","table-items"),n=t.append("div").attr("class","table-items-berlin")},s.remove=function(){d3.selectAll(".table-item").remove()},s.updateBerlin=function(t,e){tableItem=n.selectAll("div").data(e).enter().append("div").attr("class","table-item").on("click",function(){d3.select(this).classed("active",!d3.select(this).classed("active"))}),tableItem.append("div").attr("class","td-index").text(function(e,n){var a="";switch(t){case"count_students":a=e.rStudents;break;case"count_studies":a=e.rStudies;break;case"year":a=e.rAge}return a}),tableContent=tableItem.append("div").attr("class","td-content"),tableItemValue=tableItem.append("div").attr("class","td-value").text(function(e,n){return e[t]}),tableContent.append("div").attr("class","td-headline").text(function(t){return t.name}),a=tableContent.append("div").attr("class","td-subline"),r=a.append("div").attr("class","table-col col1"),i=a.append("div").attr("class","table-col col2"),l=a.append("div").attr("class","table-col col3"),r.append("div").attr("class","td-county").text(function(t){return t.county}),i.append("div").attr("class","td-studies").text(function(t){return"".concat(t.count_studies," studies")}),r.append("div").attr("class","td-year").text(function(t){return"".concat(t.year," gegründet")}),i.append("div").attr("class","td-students").text(function(t){return"".concat(t.count_students," students")}),l.append("div").attr("class","td-sponsor").text(function(t){return t.sponsor})},s.update=function(t,n){tableItem=e.selectAll("div").data(n).enter().append("div").attr("class","table-item").on("click",function(t){d3.select(this).classed("active",!d3.select(this).classed("active"))}),tableItem.append("div").attr("class","td-index").text(function(t,e){return e+1}),tableContent=tableItem.append("div").attr("class","td-content"),tableItemValue=tableItem.append("div").attr("class","td-value").text(function(e,n){return e[t]}),tableContent.append("div").attr("class","td-headline").text(function(t){return t.name}),a=tableContent.append("div").attr("class","td-subline"),r=a.append("div").attr("class","table-col col1"),i=a.append("div").attr("class","table-col col2"),l=a.append("div").attr("class","table-col col3"),r.append("div").attr("class","td-county").text(function(t){return t.county}),i.append("div").attr("class","td-studies").text(function(t){return"".concat(t.count_studies," studies")}),r.append("div").attr("class","td-year").text(function(t){return"".concat(t.year," gegründet")}),i.append("div").attr("class","td-students").text(function(t){return"".concat(t.count_students," students")}),l.append("div").attr("class","td-sponsor").text(function(t){return t.sponsor})},s};d3.queue().defer(d3.json,"../data/unis.json").defer(d3.json,"../data/merged.topojson").defer(d3.json,"../data/berlin.topojson").await(function(t,e,n,a){rankedByAge=rankedData("year",dataGlobal=e),rankedByStudents=rankedData("count_students",dataGlobal,"descending"),rankedByStudies=rankedData("count_studies",dataGlobal,"descending"),filterDefault=rankedData("count_students",dataGlobal,"descending").slice(0,9),berlinStudents=getBerlinUnis(rankedByStudents).slice(0,9),berlinStudies=getBerlinUnis(rankedByStudies).slice(0,9),berlinAge=getBerlinUnis(rankedByAge).slice(0,9),dataGlobal=rankedByStudies,unis_berlin=e.filter(function(t){return"Berlin"==t.county});var r=unis_berlin.filter(function(t){return"private"==t.sponsor}),i=unis_berlin.filter(function(t){return"public"==t.sponsor}),l=unis_berlin.filter(function(t){return"by church"==t.sponsor});r.forEach(function(t){t.count_students}),i.forEach(function(t){t.count_students}),l.forEach(function(t){t.count_students}),(map_chart=mapChart(e,n,"",filterKey,d3.select("#map_Chart"),projGer,"GER")).init(),(map_chart_legend=legend(d3.select("#legend-bars"))).init(),(bee_chart=beeChart(e,"",filterKey,d3.select("#bee_Chart"),"GER")).init(),(tool_tip=tooltip(e,d3.select("#_tooltip"))).init(),(brushed_tool_tip=brushedTooltip(e,d3.select("#brushed-tooltip"),"GER")).init(),(map_chart_berlin=mapChart(unis_berlin,n,"",filterKey,d3.select("#mapChartBerlin"),projBerlin,"BER")).init(),(map_chart_berlin_legend=legend(d3.select("#legend-berlin-bars"))).init(),(bee_chart_berlin=beeChart(unis_berlin,"",filterKey,d3.select("#beeChartBerlin"),"BER")).init(),(tool_tip_berlin=tooltip(unis_berlin,d3.select("#tooltip-berlin"))).init(),(brushed_tool_tip_berlin=brushedTooltip(unis_berlin,d3.select("#brushed-tooltip-berlin"),"BER")).init(),(table_ranking=table()).init(),table_ranking.update("count_students",filterDefault),table_ranking.updateBerlin("count_students",berlinStudents)}),round=function(t){return Math.round(100*t)/100},numberFormat=function(t){var e=t.toString().split(".");return t>9999&&(e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,".")),e.join(",")};var btnOldest=document.getElementById("filter--oldest"),btnDiverse=document.getElementById("filter--diverse"),btnSmallest=document.getElementById("filter--countStudents"),btnSortOrder=document.getElementById("filter--sortOrder");btnSortOrder.addEventListener("click",function(){var t,e;order="ascending"==order?"descending":"ascending";switch(btnSortOrder.innerHTML={ascending:"Sorting order: ascending",descending:"Sorting order: descending"}[order],filterSwitch){case"year":t=rankedData("year",dataGlobal,order),e=getBerlinUnis(t);break;case"count_studies":t=rankedData("count_studies",dataGlobal,order),e=getBerlinUnis(t).slice(0,9);break;case"count_students":t=rankedData("count_students",dataGlobal,order),e=getBerlinUnis(t).slice(0,9)}t=t.slice(0,9),e=e.slice(0,9),table_ranking.remove(),table_ranking.update(filterSwitch,t),table_ranking.updateBerlin(filterSwitch,e)}),btnOldest.addEventListener("click",function(){filterSwitch="year";var t=filterData("year",dataGlobal,"descending");table_ranking.remove(),table_ranking.update("year",t),table_ranking.updateBerlin("year",berlinAge),d3.selectAll("button").classed("active",!1),d3.select("#filter--oldest").classed("active",!d3.select("#filter--oldest").classed("active"))}),btnSmallest.addEventListener("click",function(){filterSwitch="count_students";var t=filterData("count_students",dataGlobal,"descending");table_ranking.remove(),table_ranking.update("count_students",t),table_ranking.updateBerlin("count_students",berlinStudents),d3.selectAll("button").classed("active",!1),d3.select("#filter--countStudents").classed("active",!d3.select("#filter--countStudents").classed("active"))}),btnDiverse.addEventListener("click",function(){filterSwitch="count_studies";var t=filterData("count_studies",dataGlobal,"descending");table_ranking.remove(),table_ranking.update("count_studies",t),table_ranking.updateBerlin("count_studies",berlinStudies),d3.selectAll("button").classed("active",!1),d3.select("#filter--diverse").classed("active",!d3.select("#filter--diverse").classed("active"))}),setTimeout(function(){btnOldest.click(),btnSortOrder.click()},1e3);